/*! Version: 4.2.18; Third Party Notices: https://res-1.cdn.office.net/midgard/versionless/tpn-051bef26f294aad48d7d2c6c9f68d420e57dcaf2a94d49ca38799572faa8aea06ad5c9e2affa2eb8bc6dacd881cb2182fce35aecdad68ab1530a7401af444b32.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[167],{1123:function(e,t,n){"use strict";n.r(t);var r=n(2021),o=n(1381),a=n(7),i=n(31),c=n(176),u=n(1056),s=n(1843),l=n(1203),d=n(208),f=n(879),p=n(0),g=n(127),b=n(1558),v=n(121),h=n(1386),m=n(668),C=n(645),j=n(696),O=n(400),y=n(143),S=n(1346),k=n(180),x=n(1273),w=n(665),P=n(399),A=n(1191),E=n(1370),T=n(1383),I=n(27),L=n.n(I),D=n(45),N=n(46),U=n(81),R=n(80),V=n(51),_=n(1592),M=n(1217),K=n(1094),F=n(1103),B=n(2e3),z=n(1630),W=n(192),q=n(1),H=(Object(q.declareStringWithPlaceholders)("lpc-core.inferredContact.newInformationBlock.message")),Z=(Object(q.declareString)("lpc-core.inferredContact.newInformationBlock.link")),J=n(20),G=n(278),Y=n(120),Q=Object(G.c)(function(e){return Object(J.cb)({messageBarContainer:{padding:"".concat(Y.h,"px ").concat(Y.i,"px ").concat(Y.f,"px ").concat(Y.i,"px")},root:{border:"1px solid ".concat(e.palette.neutralLighter),borderRadius:"2px",selectors:{"& .ms-Link":{paddingLeft:"0px"}}},iconContainer:{marginTop:"14px",marginLeft:"".concat(Y.i,"px"),fontSize:"13px"},text:{margin:"".concat(Y.i,"px ").concat(Y.h,"px ").concat(Y.i,"px 6px")}})});function $(e){var t=function(){if("undefined"==typeof Reflect||!L.a)return!1;if(L.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(L()(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(V.a)(e);if(t){var o=Object(V.a)(this).constructor;n=L()(r,arguments,o)}else n=r.apply(this,arguments);return Object(R.a)(this,n)}}var X=function(e){Object(U.a)(n,e);var t=$(n);function n(){return Object(D.a)(this,n),t.apply(this,arguments)}return Object(N.a)(n,[{key:"render",value:function(){var e=this.props,t=e.person,n=e.onShowDetailsClicked,r=Q(this.props.theme),o=t&&(t.displayName||t.email&&t.email.Address);if(!o)return null;var a=p.createElement(F.a,{onClick:n,href:"#"},Z());return p.createElement("div",{className:r.messageBarContainer},p.createElement(B.a,{messageBarType:z.a.info,isMultiline:!0,styles:r},p.createElement(_.a,{text:H,placeholders:{name:o,newInfo:a}})))}}]),n}(W.a);var ee=Object(M.a)(X,function(e){return{componentName:"InferredContactCard",identifier:e.person.lpcKey.key,logProperties:{propertyNames:e.properties}}}),te=Object(K.a)(ee),ne=n(1351),re=(n(6),n(554)),oe=n(132),ae=n(252),ie=n(242),ce=(n(82),n(649),n(643),n(338)),ue=(n(145),n(499),n(792));var se=n(1791),le=n(1604),de=(q.declareString("lpc-core.LivPersonaCardStrings.userInfoBlockStrings.emptyContactMessage")),fe=n(566),pe=Object(fe.a)(function(e){return{noContactInfoStyles:{color:e.palette.neutralSecondary,padding:"0 ".concat(Y.l,"px"),fontSize:e.fonts.small.fontSize},tagsStyles:{padding:"".concat(e.spacing.s2," 0")}}}),ge=2,be=2,ve=Object(c.a)(function(e,t,n){return function(){!function(e,t){var n=t.applicationContext,r=t.renderingContext,o=Object(ie.b)(n);n.settings.isImmersiveProfileEnabled&&!!o&&o?(Object(oe.k)(e,t),n.dispatch(Object(ae.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Contact",windowId:r.windowId,navigationStartCheckpoint:Object(re.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),o.renderExpandedView(n,"Contact")):(n.dispatch(Object(ae.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1})),n.settings.isNewOofDesignEnabled||Object(ue.a)(n,e))}(e,{applicationContext:t,renderingContext:n,cardCorrelationId:t.cardCorrelationId||"",logger:t.logger})}}),he=Object(c.a)(function(e,t,n){return function(){!function(e,t){var n=t.applicationContext,r=t.renderingContext,o=Object(ie.b)(n);n.settings.isImmersiveProfileEnabled&&!!o&&o?(Object(oe.k)(e,t),n.dispatch(Object(ae.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Contact",windowId:r.windowId,navigationStartCheckpoint:Object(re.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),o.renderExpandedView(n,"Contact")):(n.dispatch(Object(ae.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1})),n.settings.isNewOofDesignEnabled||Object(ue.a)(n,e))}(e,{applicationContext:t,renderingContext:n,cardCorrelationId:t.cardCorrelationId||"",logger:t.logger})}}),me=Object(c.a)(function(e,t,n){return function(){!function(e,t){var n=Object(ie.b)(t.applicationContext);Object(oe.k)(e,t),t.applicationContext.dispatch(Object(ae.e)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Contact",windowId:t.renderingContext.windowId,navigationStartCheckpoint:Object(re.a)(),shouldResetHistory:!1,personaCorrelationId:t.applicationContext.getPersonaCorrelationId(e.lpcKey)})),n&&n.renderExpandedView(t.applicationContext,"Contact"),Object(ce.b)(t.applicationContext.dispatch)}(e,{applicationContext:t,renderingContext:n,cardCorrelationId:t.cardCorrelationId||"",logger:t.logger}),Object(T.b)(e,t)}});var Ce=Object(g.c)(function(e){var t=Object(v.c)(e,"Card"),n=!!Object(v.l)(e,t),r=!!(t?Object(v.g)(e,t.lpcKey):void 0),o=y.a.getSelectors(e).settings.isPSTNWorkaroundActive,a=y.a.getSelectors(e).settings.isRichAvailabilityInfoEnabled,c=a&&Object(i.p)(t)?j.a.getSelectors(e).getTimeZoneOffset(t.lpcKey):void 0,u=t&&m.a.getSelectors(e).getContactTags(t.lpcKey.key)||[],s=y.a.getSelectors(e).settings.isNextAvailabilityEnabled,l=s&&Object(i.p)(t)?j.a.getSelectors(e).getNextAvailability(t.lpcKey):void 0,d=Object(i.p)(t)?O.a.getSelectors(e).getPersonaPresence(t.lpcKey):void 0,f=Object(i.p)(t)?Object(h.a)(e,t.lpcKey):void 0;return{isMePage:n,currentPersona:t,hasInferredContactData:r,isPSTNWorkaroundActive:o,isNextAvailabilityEnabled:s,isRichAvailabilityInfoEnabled:a,timeZoneOffset:c,canUpdateProfileVideo:Object(i.p)(t)&&n&&Boolean(!C.a.getSelectors(e).getProfileVideoPlaybackUrl(t.lpcKey)),nextAvailability:l,richPresence:d,oof:f,tags:u}})(Object(A.a)(function(e){var t,n,c,g,v,h,m,C=e.person,j=[],O=e.tags,y=Object(f.a)(),A=pe(y);if(Object(i.p)(C)){var T=Object(i.g)(C,e.isPSTNWorkaroundActive);g={contactType:"phone",content:Object(i.l)(T).map(function(e){return{displayString:e.PhoneNumber,hrefLink:e.PhoneUrl,fieldType:e.Type}}).slice(0,ge)},v=(h=Object(se.c)(C)).address?{contactType:"location",content:Object(se.a)([h.address],[h.address])}:void 0;var I=[C.email?C.email.Address:""].concat(C.extraEmails.map(function(e){return e.Address})).filter(function(e){return!Object(d.e)(e)}).slice(0,be);c={contactType:"email",content:Object(se.a)(I,I).slice(0,be)};m=e.lpcAppContext.settings.isProfileVideoEnabled&&e.canUpdateProfileVideo?{contactType:"updateprofilevideo",content:Object(se.a)([Object(ne.j)()],["updateprofilevideo"])}:void 0}if(Object(l.a)({componentName:"ContactBlock",identifier:C.lpcKey.key,logProperties:{emailCount:c?c.content.length.toString():"0",phoneCount:g?g.content.length.toString():"0",hasLocation:Boolean(h),locationType:h?Boolean(h.address)&&h.locationType:"",isInferredContactsEnabled:e.lpcAppContext.settings.isInferredContactsEnabled,hasInferredContactData:e.hasInferredContactData,isContactMergeSuggestionsEnabled:Object(w.b)(e.lpcAppContext),isContactCategoriesEnabled:Object(S.a)(e.lpcAppContext),contactCategoriesCount:O?O.length.toString():"0",isMe:e.isMePage,isTimeZoneEnabled:e.isRichAvailabilityInfoEnabled,hasTimeZoneData:void 0!==e.timeZoneOffset,isNextAvailabilityEnabled:e.isNextAvailabilityEnabled,hasNextAvailabilityData:Boolean(e.nextAvailability&&e.richPresence)}}),Object(S.a)(e.lpcAppContext)&&(null==O?void 0:O.length)){var L=O,D=p.createElement(s.a,{logger:e.lpcAppContext.logger,featureName:"ContactCategories",eventFieldMap:E.b},p.createElement("div",{className:A.tagsStyles},p.createElement(r.a,{contactId:C.contactId||"",showAll:!1,showDelete:function(){return!1},tags:L,onShowMoreClick:he(C,e.lpcAppContext,e.renderingContext),onTagClick:function(t){Object(b.a)(e.lpcAppContext,t)}}))),N=p.createElement(o.a,{contactLinkType:"tag",icon:a.b.Category,firstLine:"",firstLineOverride:D,logPrefix:"",styleOverrides:function(){return{container:{"&:active, &:hover, &:focus":{background:"none"}}}}});j=j.concat(N)}if(e.shouldShowInferredContact){var U=Object(x.c)(e.inferredContact);j=j.concat(p.createElement(te,{person:C,properties:U,onShowDetailsClicked:he(C,e.lpcAppContext,e.renderingContext)}))}var R=[c,g,v,m].filter(function(e){return e});0!==R.length||e.shouldShowInferredContact||(j=j.concat(function(e){var t=pe(e);return p.createElement("div",{className:t.noContactInfoStyles},de())}(y)));var V=[],_=Object(u.a)(e.richPresence);if(e.isNextAvailabilityEnabled&&void 0!==e.nextAvailability){var M=Object(se.b)(e.nextAvailability,e.richPresence,e.oof,_,e.lpcAppContext.culture,e.lpcAppContext.settings.useMicrosoftTeamsFeatures,e.isMePage,Object(P.d)(e.lpcAppContext));void 0!==M&&V.push({contactType:"nextavailability",content:[M]})}void 0!==e.timeZoneOffset&&V.push({contactType:"timezone",content:[Object(se.d)(e.timeZoneOffset,Object(P.b)(e.lpcAppContext),e.isMePage)]});var K=Object(i.p)(e.currentPersona)&&(null===(t=e.currentPersona)||void 0===t?void 0:t.isMixedChatUser),F=Object(k.c)(e.lpcAppContext.hostAppConfiguration.tenantAadObjectId),B=Object(i.p)(e.currentPersona)?null===(n=e.currentPersona)||void 0===n?void 0:n.firstName:void 0,z=p.useMemo(function(){return{isMixedChatUser:K,isConsumer:F,displayName:B}},[K,F,B]);return p.createElement(le.a,{onTitleClick:ve(C,e.lpcAppContext,e.renderingContext),onFooterClick:he(C,e.lpcAppContext,e.renderingContext),onUpdateProfileVideoClick:me(C,e.lpcAppContext,e.renderingContext),showLoading:!C,additionalChildren:j,additionalAvailabilityInfo:V,contacts:R,mixedChatDisclaimerProps:z,hideTitle:K})}));t.default=Ce},1191:function(e,t,n){"use strict";n.d(t,"b",function(){return m});var r=n(27),o=n.n(r),a=n(4),i=n.n(a),c=n(45),u=n(46),s=n(81),l=n(80),d=n(51),f=n(444),p=n(635),g=n(1170),b=n(0),v=n(141);function h(e){var t=function(){if("undefined"==typeof Reflect||!o.a)return!1;if(o.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(o()(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var a=Object(d.a)(this).constructor;n=o()(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var m=function(e){var t;return(t=function(t){Object(s.a)(r,t);var n=h(r);function r(){return Object(c.a)(this,r),n.apply(this,arguments)}return Object(u.a)(r,[{key:"render",value:function(){var t=Object(p.b)(this).getSingleton(v.a),n=i()(i()({},this.props),{lpcAppContext:t});return b.createElement(e,i()({},n))}}]),r}(b.Component)).contextTypes=i()({},f.b),t};t.a=function(e){return Object(g.a)(m(e))}},1194:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(486),o=n(0),a=n(640);function i(){return Object(o.useContext)(a.a)||Object(r.throwError)("LPCAppContext not found.")}},1203:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(150),o=n(2),a=n(0),i=n(644),c=n(1259);function u(e){var t=Object(i.c)(),n=Object(i.d)(),u=e.identifier,s=e.logProperties,l=n+e.componentName,d=Object(a.useRef)(null),f=Object(a.useRef)(null),p=Object(a.useRef)(null),g=Object(a.useRef)(0);Object(a.useEffect)(function(){return null===d.current&&(d.current=c()),function(){f.current||(f.current=c());var e=d.current&&f.current?f.current-d.current:void 0,n=void 0!==e&&Math.round(e).toString()||"";if(t){var r=Object(o.__assign)({component:l,duration:n,renderCount:g.current.toString()},p.current);t(l,r)}d.current=null,p.current=null,f.current=null,g.current=0}},[u,l]),Object(a.useEffect)(function(){Object(r.a)(s,p.current)||(g.current++,f.current=c(),p.current=s)},[l,s])}},1212:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"f",function(){return l}),n.d(t,"g",function(){return j}),n.d(t,"d",function(){return O}),n.d(t,"c",function(){return y}),n.d(t,"a",function(){return k}),n.d(t,"b",function(){return x});var r=n(59),o=n.n(r),a=n(1),i=n(18),c=n(1079),u=n(64),s=(Object(a.declareString)("datetime-formatting.contactDetails.localTimeLabel")),l=(Object(a.declareString)("datetime-formatting.contactDetails.myTimeZoneLabel")),d=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.timeZoneBehind")),f=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.timeZoneAhead")),p=(Object(a.declareString)("datetime-formatting.contactDetails.sameTimeZone")),g=(Object(a.declareString)("datetime-formatting.contactDetails.separator")),b=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.freeFrom")),v=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.freeUntil")),h=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.oofUntil")),m=(Object(a.declareString)("datetime-formatting.contactDetails.freeToday")),C=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.dateAndTime")),j=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.presenceAndNextAvailability"));function O(e,t,n){var r=g();return n?e:"".concat(e," ").concat(r," ").concat(t)}function y(e,t){var n=new Date,r=Object(u.g)(n);if(r===e)return p();var o=r-e,a=Object(c.c)(n,o,t);return o>0?f({p0:a}):d({p0:a})}function S(e,t,n,r){void 0===r&&(r=!1);var a=Intl.DateTimeFormat(t,{day:"2-digit",month:"short"}).format(e);if(r)return a;var i=new Date(o()()),c=e.getDay()===i.getDay(),u=Intl.DateTimeFormat(t,{hour:"numeric",minute:"2-digit",hour12:!n}).format(e);return c?u:C({date:a,time:u})}function k(e,t,n,r,o){if((t!==n||"Unknown"!==n)&&void 0!==e){if(t===n&&"Free"===n)return m();var a,c=(a=new Date(e),new Date(a.getTime()-a.getTimezoneOffset()*i.p));if("Oof"===t)return x(c,r,o);var u=S(c,r,o);return"Free"===n?b({time:u}):v({time:u})}}function x(e,t,n){if(void 0!==e){var r=S(e,t,n,!0);return h({time:r})}}},1217:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),o=n(0),a=n(1203);function i(e,t){return function(n){var i=t(n);return Object(a.a)(i),o.createElement(e,Object(r.__assign)({},n))}}},1224:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var r={Accept:"application/json","Content-Type":"application/json"},o={convertPropertiesToPascalCase:!1,defaultResponseObject:!1}},1226:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return f});var r=n(4),o=n.n(r),a=n(6),i=n.n(a),c=n(38);function u(e){var t=e.parsedResponse;return t||"number"==typeof t||"boolean"==typeof t||"string"==typeof t?{state:"success",data:t}:{state:"no_data"}}function s(e){return"rest_provider"===(null==e?void 0:e.errorCode)?{state:"error",errorCode:e.errorCode}:401===(null==e?void 0:e.statusCode)?{state:"error",errorCode:"unauthorized"}:404===(null==e?void 0:e.statusCode)?{state:"error",errorCode:"not_found"}:(t=null==e?void 0:e.statusCode,Boolean(t&&t>=500&&t<600)?{state:"error",errorCode:"server_error"}:{state:"error",errorCode:"unknown_error"});var t}function l(){return i.a.resolve({state:"no_data"})}function d(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(o()({},t),{clientScenario:t.clientScenario,requestId:null!==(e=t.requestId)&&void 0!==e?e:Object(c.a)()})}function f(e,t){if(!e)return l;var n="function"==typeof e?e():i.a.resolve(e);return function(){return n.then(function(e){return t(e).then(u).catch(s)})}}},1230:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return S}),n.d(t,"d",function(){return k}),n.d(t,"c",function(){return x}),n.d(t,"f",function(){return w}),n.d(t,"g",function(){return P}),n.d(t,"h",function(){return A}),n.d(t,"e",function(){return E});var r=n(332),o=n(31),a=n(335),i=n(92),c=n(108),u=n(70),s=n(563),l=n(658),d=function(){},f=n(99),p=n(1287),g=n(441),b=n(6),v=n.n(b),h=n(632),m=n(38),C=n(82);function j(e){var t=e.scenarioName,n=e.lpcAppContext,r=e.logger,o=e.persona,a=e.operation,i=e.successAction,c=e.errorAction,u=Boolean(a);Object(h.a)({scenarioName:t,featureName:"HostAppCallbacks",requestId:Object(m.a)(),operation:function(){return u&&a?(a(o&&Object(C.a)(n.getState(),o,n.hostAppConfiguration.loggedInUserUpn)),v.a.resolve()):v.a.reject("HostApp does not implement the callback")},monitorStarter:r,successAction:function(e){n.dispatch(i())},errorAction:function(){n.dispatch(c({HostAppCallbackNotImplemented:!u}))},treatAsExpectedError:function(e){return!u}})}var O=n(453);function y(e){var t=e.person,n=e.lpcAppContext,r=e.sectionType,o=e.renderingContext,a=e.logger;Object(l.a)(r)?n.dispatch(Object(c.d)({personaLpcKey:t.lpcKey,sectionType:r})):n.dispatch(Object(u.u)()),O.a(t,n,o,a)}function S(e,t,n){t.dispatch(Object(c.c)({personaLpcKey:e,sectionType:n}))}function k(e){var t=e.personaLpcKey,n=e.lpcAppContext,r=e.sectionType,a=e.renderingContext,i=e.focusPropertyUri,s=e.logger,d=Object(f.b)(n.getState(),t);Object(o.p)(d)&&d.olsPersonaId?("PersonaBodies"===i?n.dispatch(Object(c.a)({personaLpcKey:t,contactId:d.olsPersonaId,sectionType:r})):Object(l.a)(r)?n.dispatch(Object(c.t)({personaLpcKey:t,contactId:d.olsPersonaId,sectionType:r})):n.dispatch(Object(u.v)()),O.d(d,d.olsPersonaId,n,a,s,i)):console.error("Cannot edit contact")}function x(e){var t=e.applicationContext,n=e.phoneType,o=e.contactNumber,a=e.annotation,i=e.persona,u=e.expandedViewSection,l=e.props,d=e.logger,f=t.hostAppConfiguration.actionCallbacks,p=f&&f.handleContactNumber,g=O.b(n);if(t.dispatch(u?Object(c.l)({phoneType:n,section:u,logger:d}):Object(c.q)({phoneType:n})),p&&a&&i)j({scenarioName:"ContactActionCreatorsHandleContactNumber",lpcAppContext:t,logger:d,persona:i,operation:p?function(e){return e&&p(o,a,g,e,l,d)}:void 0,successAction:s.d,errorAction:s.c});else{var b={openType:"CurrentTab",hrefLink:o};Object(r.a)(b,t)}}function w(e,t){var n=t.persona,r=t.props,o=t.expandedViewSection,i=t.shouldCloseExpandedView,u=void 0!==i&&i,s=t.applicationContext,l=t.logger;"Outlook_Android"!==s.hostAppConfiguration.source&&"Outlook_iOS"!==s.hostAppConfiguration.source&&"OutlookMobileAndroid"!==s.hostAppConfiguration.source&&"OutlookMobileiOS"!==s.hostAppConfiguration.source||d(),s.dispatch(o?Object(c.i)({shouldCloseExpandedView:u,windowId:(null==r?void 0:r.windowId)||a.a,section:o,logger:l}):Object(c.p)({logger:l})),Object(g.g)(s,l)({persona:n,recipientId:e,properties:r})}function P(e,t,n,r,o,s){e.dispatch("Header"===n?Object(u.l)():"UserInfoView"===n?Object(c.r)({logger:r}):Object(c.m)({section:n})),Object(p.b)(t,e,r,o,function(){e.dispatch(Object(i.j)({windowId:a.a,shouldCloseCard:Boolean(s)}))})}function A(e,t){e.dispatch(Object(c.o)()),Object(r.a)(t,e)}function E(e,t){t.dispatch(Object(c.k)()),Object(r.a)(e,t)}},1241:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var r=n(3),o=Object(r.a)("CopyToClipboardSucceededAction",{featureName:"DOMEvent",getLogProperties:function(e){return{targetName:e.targetName}}}),a=Object(r.a)("CopyToClipboardFailedAction",{featureName:"DOMEvent",getLogProperties:function(e){return{targetName:e.targetName}}})},1246:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return u});var r=n(18),o=n(33),a=n(443);function i(e,t){return Object(o.format)(t.timeFormats.todayShort,e,new Date,t,void 0).trim()}function c(e,t,n){void 0===n&&(n=new Date);var r=Object(a.d)(n,e);return Object(o.format)(t.timeFormats.todayShort,r,n,t,void 0,e).trim()}function u(e,t,n,a){var c=new Date(Date.UTC(0,0,0,0,0,t)),u=new Date(c.getTime()+c.getTimezoneOffset()*r.p),s=new Date(Date.UTC(0,0,0,0,0,n)),l=new Date(s.getTime()+s.getTimezoneOffset()*r.p),d=i(u,a),f=i(l,a),p=Object(o.formatTimeZone)(a.timeFormats.timeZone,e);return"".concat(d," - ").concat(f," (").concat(p,")")}},1259:function(e,t,n){(function(t){(function(){var n,r,o,a,i,c;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-i)/1e6},r=t.hrtime,a=(n=function(){var e;return 1e9*(e=r())[0]+e[1]})(),c=1e9*t.uptime(),i=a-c):Date.now?(e.exports=function(){return Date.now()-o},o=Date.now()):(e.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(this,n(878))},1262:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return f});var r=n(94),o=n.n(r),a=n(1300),i=n(208),c=n(245),u=n(45),s=n(46),l=function(){function e(){Object(u.a)(this,e)}return Object(s.a)(e,[{key:"load",value:function(e,t,n){if(this.isLoaded(e))t();else{var r=document.getElementsByTagName("head")[0],o=document.createElement("script");o.type="text/javascript",o.onload=function(){return t()},n&&n.forEach(function(e,t){o.setAttribute(t,e)}),o.src=e,r.appendChild(o)}}},{key:"isLoaded",value:function(e){for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++)if(t[n].src===e)return!0;return!1}}]),e}();function d(e){var t=new l,n=e.hostAppConfiguration.lokiUrl,r="PROD";e.settings.isSkypeWebControlIntEnvironmentEnabled?r="INT":n&&"df"===Object(a.a)(n)&&(r="DF");var i=(new o.a).set("data-environment",r).set("data-manualbootstrap","true");t.load("https://latest-swc.cdn.skype.com/sdk/v1/sdk.js",function(){return e.dispatch(c.c())},i)}function f(e){return"string"!=typeof e||Object(i.d)(e)}},1273:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"f",function(){return C}),n.d(t,"b",function(){return j}),n.d(t,"d",function(){return O}),n.d(t,"c",function(){return y}),n.d(t,"e",function(){return S});var r=n(4),o=n.n(r),a=n(10),i=n.n(a),c=n(6),u=n.n(c),s=n(223),l=n(79),d=n(145),f=n(405),p=n(458),g=n(19),b=n(56),v=function(e,t,n,r){return new(n||(n=u.a))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}u((r=r.apply(e,t||[])).next())})},h="InferredContacts",m="PromoteInferredContactSaveButtonClickedAction";function C(e,t){return e.settings.isInferredContactsEnabled&&!!t}var j=function(e){var t=e.inferredContact,n=e.person,r=e.sectionType,o=e.lpcAppContext,a=e.renderingContext,c=e.logger,u=y(t),s=O(n,t),l=[{propertyUri:"PersonaCompanyNames",value:t.Company||""},{propertyUri:"PersonaSurnames",value:t.Surname||""},{propertyUri:"PersonaGivenNames",value:t.GivenName||""},{propertyUri:"PersonaTitles",value:t.JobTitle||""},{propertyUri:"PersonaBusinessPhoneNumbers",value:t.TelephoneNumbers&&t.TelephoneNumbers[0]||""},{propertyUri:"PersonaBusinessPhoneNumbers2",value:t.TelephoneNumbers&&t.TelephoneNumbers[1]||""},{propertyUri:"PersonaTitles",value:t.JobTitle||""},{propertyUri:"PersonaEmails1",value:t.Emails&&t.Emails[0]||""},{propertyUri:"PersonaEmails2",value:t.Emails&&t.Emails[1]||""},{propertyUri:"PersonaEmails3",value:t.Emails&&t.Emails[2]||""}];t.Address&&t.Address.value&&(l=l.concat({propertyUri:"PersonaHomeAddresses",value:t.Address.value})),o.dispatch(Object(f.a)({sectionType:r}));var d={onSave:function(e){!function(e,t,n,r,o,a){v(this,void 0,void 0,i.a.mark(function c(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,S(e,t,r,o,a);case 2:a.logUserInteractionEvent({eventId:m,featureName:h,properties:{propertyNames:n}});case 3:case"end":return i.stop()}},c)}))}(s,n||Object(b.a)(),u,o,a,c)},onCancel:function(){}};p.b(o,{folderId:"",createCallbacks:d,initialValues:l.filter(function(e){return""!==e.value})})};function O(e,t){return e.email&&e.email.Address||t&&t.Emails&&t.Emails[0]||""}function y(e){if(void 0===e)return"";var t=[];return Object(s.keys)(e).forEach(function(n){void 0!==e[n]&&null!==e[n]&&t.push(n)}),t.join(",")}function S(e,t,n,r,a){return v(this,void 0,void 0,i.a.mark(function c(){return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(d.g)(e,n,r,a);case 2:return i.next=4,g.F.fetch(n,t.lpcKey,o()(o()({},Object(l.a)(t)),{locale:n.culture}));case 4:case"end":return i.stop()}},c)}))}},1281:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return d});var r=n(4),o=n.n(r),a={unknown_error:1,not_found:1,server_error:1,unauthorized:1,rest_provider:1,host_app_callback:1};function i(e){return function(t){return"no_data"===t.state?t:"success"===t.state?o()(o()({},t),{data:e(t.data)}):o()(o()({},t),{previousData:t.previousData&&e(t.previousData)})}}function c(e){if("no_data"!==e.state)return"success"===e.state?e.data:e.previousData}function u(e,t,n){switch(e){case"idle":case"loading":return{state:"not_asked",previousData:l(t)};case"error":return{state:"error",errorCode:s(n),previousData:l(t)};case"success":return t||d;default:return d}}function s(e){return"string"==typeof e&&a.hasOwnProperty(e)?e:"unknown_error"}function l(e){switch(null==e?void 0:e.state){case"not_asked":case"error":return e.previousData;case"no_data":return;case"success":return e.data;default:return}}var d={state:"no_data"}},1287:function(e,t,n){"use strict";n.d(t,"b",function(){return p}),n.d(t,"a",function(){return b});var r=n(332),o=n(16),a=n(82),i=n(316),c=n(245),u=n(180),s=n(1262);function l(e,t,n){if(Object(u.c)(e.hostAppConfiguration.tenantAadObjectId)){var r={ConversationId:t,CorrelationId:e.cardCorrelationId,ConversationType:"person",TrafficProvider:"lpc",TrafficSource:e.hostAppConfiguration.source},o=e.ownerWindow.SkypeWebControl;if(o){o.SDK&&o.SDK.Chat&&o.SDK.Chat.isInitialized?o.SDK.Chat.startChat(r):o.SDK&&o.SDK.start&&(e.ownerWindow.addEventListener("swc:ready",function t(){o.SDK.Chat.startChat(r),e.ownerWindow.removeEventListener("swc:ready",t)}),o.SDK.start()),Object(i.c)(e,n)}}else Object(s.b)(e),e.dispatch(Object(c.e)())}var d="StartWorkloadChat",f="Tenant opted out of skype chat";function p(e,t,n,r,i){var c=t.settings.useMicrosoftTeamsFeatures;if(Object(u.c)(t.hostAppConfiguration.tenantAadObjectId))return r&&l(t,r,n),void(i&&i());var s=t.hostAppConfiguration.actionCallbacks,p=e.imAddresses.length&&e.imAddresses[0].ImAddressUrl&&0===e.imAddresses[0].ImAddressUrl.trim().indexOf("sip:"),b=e.imAddresses.length&&e.imAddresses[0].ImAddress||"",v=e.imAddresses.length&&e.imAddresses[0].ImAddressUrl||"",h=Object(o.m)(e)||"";(p&&b&&v||c)&&s&&s.startChat?function(e,t,n,r,o,i,c,u){var s=i.startMonitor(d,"WorkloadChat"),l=Object(a.a)(t.getState(),e,t.hostAppConfiguration.loggedInUserUpn);c({persona:l,smtpAddress:n,imAddress:r,imAddressUrl:o},function(n,r){n?(u&&u(),s.success(void 0)):(g(e,t),r===f?s.expectedFailure(r):s.unexpectedFailure(r||"Unknown"))})}(e,t,h,b,v,n,s.startChat,i):g(e,t)}function g(e,t){var n={openType:"CurrentTab",hrefLink:e.imAddresses.length&&e.imAddresses[0].ImAddressUrl||""};Object(r.a)(n,t)}function b(e,t,n){var r=Object(u.c)(e.hostAppConfiguration.tenantAadObjectId),o=t.imAddresses.length&&t.imAddresses[0].ImAddress||""||n,a=r&&Object(s.a)(o),i=!r&&!t.imAddresses.length;return a||i}},1291:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),o=n(0),a=n(84),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRendered:void 0===Object(a.a)()},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout(function(){e.setState({isRendered:!0})},t)},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t.prototype.render=function(){return this.state.isRendered?o.Children.only(this.props.children):null},t.defaultProps={delay:0},t}(o.Component)},1300:function(e,t,n){"use strict";function r(e){return function(e){return(e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]}(e).split(".")[0]}n.d(t,"a",function(){return r})},1322:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return s});var r=n(54),o=n.n(r),a=n(1224),i=n(1226),c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof o.a){var a=0;for(r=o()(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(i.a)(e,function(e){return function(e,t,n){return e.request("getContacttags","GET","/api/v1/contactTags",void 0,a.a,n,t,function(e){return e},a.b)}(e,Object(i.b)(n),t)})}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(i.a)(e,function(e){return function(e,t,n){var r=n.contactV3UpdateRequest,o=c(n,["contactV3UpdateRequest"]);return e.request("patchPeoplegraphcontact","PATCH","/api/v1/peoplegraph/contact",r,a.a,o,t,function(e){return e},a.b)}(e,Object(i.b)(n),t)})}},1334:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(142),o=["TEMPLATE","STYLE","SCRIPT"];function a(e){var t=Object(r.a)(e);if(!t)return function(){};for(var n=[];e!==t.body&&e.parentElement;){for(var a=0,i=e.parentElement.children;a<i.length;a++){var c=i[a],u=c.getAttribute("aria-hidden");c!==e&&"true"!==(null==u?void 0:u.toLowerCase())&&-1===o.indexOf(c.tagName)&&n.push([c,u])}e=e.parentElement}return n.forEach(function(e){e[0].setAttribute("aria-hidden","true")}),function(){!function(e){e.forEach(function(e){var t=e[0],n=e[1];n?t.setAttribute("aria-hidden",n):t.removeAttribute("aria-hidden")})}(n),n=[]}}},1346:function(e,t,n){"use strict";function r(e){var t,n;return!!(null===(n=null===(t=e.hostAppConfiguration.dataCallbacks)||void 0===t?void 0:t.isCAPIv3Enabled)||void 0===n?void 0:n.call(t))}n.d(t,"a",function(){return r})},1351:function(e,t,n){"use strict";n.d(t,"m",function(){return o}),n.d(t,"j",function(){return a}),n.d(t,"l",function(){return i}),n.d(t,"k",function(){return c}),n.d(t,"i",function(){return u}),n.d(t,"h",function(){return s}),n.d(t,"g",function(){return l}),n.d(t,"f",function(){return d}),n.d(t,"q",function(){return f}),n.d(t,"n",function(){return p}),n.d(t,"e",function(){return g}),n.d(t,"d",function(){return b}),n.d(t,"b",function(){return v}),n.d(t,"a",function(){return h}),n.d(t,"c",function(){return m}),n.d(t,"o",function(){return C}),n.d(t,"p",function(){return j});var r=n(1),o=(Object(r.declareString)("lpc-core.videoProfile.getVideoTitle")),a=(Object(r.declareString)("lpc-core.videoProfile.getUpdateProfileVideoString")),i=(Object(r.declareString)("lpc-core.videoProfile.getUploadingProgressProfileVideoString")),c=(Object(r.declareString)("lpc-core.videoProfile.getUploadingFailedProfileVideoString")),u=(Object(r.declareStringWithPlaceholders)("lpc-core.videoProfile.getCorrelationIdProfileVideoString")),s=(Object(r.declareString)("lpc-core.contactProfileVideo.getConfirmationDialogTitle")),l=(Object(r.declareString)("lpc-core.contactProfileVideo.getConfirmationDialogSubtext")),d=(Object(r.declareString)("lpc-core.contactProfileVideo.getConfirmationDialogCancelText")),f=(Object(r.declareString)("lpc-core.videoProfile.updateProfileVideoFirstLine")),p=(Object(r.declareString)("lpc-core.videoProfile.playProfileVideoFirstLine")),g=(Object(r.declareString)("lpc-core.videoProfile.deleteProfileVideoFirstLine")),b=(Object(r.declareString)("lpc-core.videoProfile.deleteProfileVideoConfirmationDialogue")),v=(Object(r.declareString)("lpc-core.videoProfile.closeVideoPanelButtonTitle")),h=(Object(r.declareString)("lpc-core.videoProfile.closeVideoPanelButtonLabel")),m=(Object(r.declareString)("lpc-core.videoProfile.closeVideoPanelClickOutsideLabel")),C=(Object(r.declareString)("lpc-core.videoProfile.recordVideoPanelButtonLabel")),j=(Object(r.declareString)("lpc-core.videoProfile.replayVideoPanelButtonLabel"))},1352:function(e,t,n){"use strict";n.d(t,"c",function(){return d}),n.d(t,"d",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"f",function(){return g}),n.d(t,"e",function(){return b}),n.d(t,"b",function(){return v});var r=n(332),o=n(335),a=n(92),i=n(108),c=n(252),u=n(441),s=n(1230),l=n(338);function d(e,t){var n=t.sourceSectionType,r=t.index,a=t.windowId,s=t.applicationContext,l=t.logger;"Card"===n||"UnknownOutsideOfExpandedView"===n?s.dispatch(Object(c.a)({indexClicked:r})):s.dispatch(Object(i.i)({shouldCloseExpandedView:!0,windowId:a||o.a,section:n,logger:l})),Object(u.g)(s,l)({recipientId:e,properties:{currentTarget:void 0,personaDisplayName:void 0,windowId:a}})}function f(e,t,n){e.dispatch(Object(c.c)({indexClicked:t}));var o=e.settings.useMicrosoftTeamsFeatures?"NewTab":"CurrentTab";if(n){var a={openType:o,hrefLink:"".concat(encodeURI(n))};Object(r.a)(a,e)}}function p(e,t,n,r,o){Object(s.g)(e,t,n,r,o)}function g(e,t){e.dispatch(Object(i.n)({personaLpcKey:t.lpcKey})),Object(l.b)(e.dispatch)}function b(e,t){e.dispatch(Object(a.i)({section:t,entryPoint:"CopyClick",viewType:"Expanded"}))}function v(e,t){e.dispatch(Object(i.j)({personaLpcKey:t.lpcKey}))}},1370:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var r={UserAction:{"Categorize.Menu.AddNewCategory":"CategorizeMenuAddNewCategoryClickAction","Categorize.Menu.ClearAllCategories":"CategorizeMenuClearAllCategoriesClick","Categorize.Menu.ShowAllCategories":"CategorizeMenuShowAllCategoriesClick","Categorize.CreateCategoryModal.NewCategorySubmit":"NewContactCategoryCreateSubmitAction","Categorize.CreateCategoryModal.NewCategoryCancel":"NewContactCategoryCreateCancelAction","Categorize.Menu.CategoryClick":"CategorizeMenuCategoryClick"}},o={UserAction:{"Content.ContactInfo.ContactCategoryPanel.CategoryDelete":"ContactCategoryPanelCategoryDeleteClick"}}},1383:function(e,t,n){"use strict";n.d(t,"b",function(){return K}),n.d(t,"a",function(){return B});var r=n(10),o=n.n(r),a=n(6),i=n.n(a),c=n(457),u=n(340),s=n(45),l=n(46),d=n(552),f=n(1062),p=n(0),g=n(67),b=n(141),v=n(338),h=n(1),m=(Object(h.declareString)("lpc-core.videoProfile.recorderTitleString")),C=(Object(h.declareString)("lpc-core.videoProfile.recorderEditTitleString")),j=(Object(h.declareString)("lpc-core.videoProfile.recorderEditDeleteTitleString")),O=(Object(h.declareString)("lpc-core.videoProfile.recorderEditDeleteBodyString")),y=(Object(h.declareString)("lpc-core.videoProfile.recorderEditDeleteConfirmString")),S=(Object(h.declareString)("lpc-core.videoProfile.recorderEditDeleteCancelString")),k=(Object(h.declareString)("lpc-core.videoProfile.recorderUploadButtonString")),x=n(4),w=n.n(x),P=n(222),A=n(1830),E=n(1997),T=n(1628),I=n(1891),L=n(127),D=n(645),N=n(1433),U=function(e,t,n,r){return new(n||(n=i.a))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}u((r=r.apply(e,t||[])).next())})};var R=Object(L.c)(function(e,t){return{retryVideoUpload:D.a.getSelectors(e).isProfileVideoRetryUpload(),unmountRecorder:D.a.getSelectors(e).isProfileVideoInitialState()}})(function(e){var t=p.useState(void 0),n=Object(P.a)(t,2),r=n[0],a=n[1],c=p.useState(),u=Object(P.a)(c,2),s=u[0],l=u[1],d=p.useState(!0),f=Object(P.a)(d,2),g=f[0],b=f[1],v=Object(N.a)(),h=Object(N.b)();e.unmountRecorder&&s&&!g&&e.videoRecorderProps.onClose();var m=function(e){return U(void 0,void 0,void 0,o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(n=e.result)&&(b(!1),C(n));case 2:case"end":return t.stop()}},t)}))},C=function(t){return U(void 0,void 0,void 0,o.a.mark(function n(){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t&&e.videoRecorderProps.handleUpdateProfileVideoClick(t).then(function(t){e.videoRecorderProps.onClose()}).catch(function(e){s||l(t)});case 1:case"end":return n.stop()}},n)}))};return e.retryVideoUpload&&s&&(C(s),e.onProfileVideoUploadRetry()),p.useEffect(function(){var t=!1;return i.a.all([e.initializeVideoRecorder(e.appContext),e.loadResources(e.videoRecorderProps.userContext.language)]).then(function(n){var r=Object(P.a)(n,2),o=r[0].VideoRecorder,i=r[1],c=w()(w()({},e.videoRecorderProps),{localizedResources:i,onRecorderReady:m}),u=p.createElement(o,w()({},c));t||a(u)}).then(function(){return e.onLoadSuccess()}).catch(function(t){return e.onLoadFailure()}),function(){t=!0}},[]),p.createElement(I.a,{isOpen:g,styles:v,isBlocking:!1},!r&&p.createElement("div",{className:h.modalWrapperStyles},p.createElement(A.a,{className:h.cancelButtonStyles,iconProps:{iconName:"Cancel"},onClick:e.videoRecorderProps.onClose}),p.createElement(E.a,{size:T.a.large,className:h.spinnerStyles})),r)}),V=function(e,t,n,r){return new(n||(n=i.a))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}u((r=r.apply(e,t||[])).next())})},_=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"renderVideoRecorder",value:function(e,t,n){var r,o=this;if(t){var a=this.appendRootElementIfNeededAndReturnIt(t),i=e.hostAppConfiguration,c=e.cardCorrelationId,s={onClose:function(){return o.closeVideoRecorder(a,t)},userContext:{userId:i.userAadObjectId||"",tenantId:i.tenantAadObjectId||"",language:(null===(r=i.culture)||void 0===r?void 0:r.split("-")[0])||""},hostContext:{hostSessionId:c||"",hostCorrelationId:i.consumerCorrelationId||"",hostVersion:""},handleUpdateProfileVideoClick:n};g.render(p.createElement(f.a,{context:t},p.createElement(R,{appContext:t,initializeVideoRecorder:this.initializeVideoRecorder,loadResources:this.loadResources.bind(this),videoRecorderProps:s,onLoadSuccess:function(){return e.dispatch(Object(u.i)({}))},onLoadFailure:function(){return e.dispatch(Object(u.h)({}))},onProfileVideoUploadRetry:function(){return e.dispatch(Object(u.l)({retryUpload:!1}))}})),a)}}},{key:"loadResources",value:function(e){return V(this,void 0,void 0,o.a.mark(function t(){var r,a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e||"en",t.next=3,n(1528)("./language-".concat(r));case 3:return a=t.sent,this.overrideWebRecorderStrings(a.default.loc.strings),t.abrupt("return",a.default);case 6:case"end":return t.stop()}},t,this)}))}},{key:"initializeVideoRecorder",value:function(e){return V(this,void 0,void 0,o.a.mark(function t(){var r,a=this;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([n.e(172),n.e(173)]).then(n.bind(null,2578));case 2:return r=t.sent,window.setTimeout(function(){return a.appendRootElementIfNeededAndReturnIt(e)},0),t.abrupt("return",r);case 5:case"end":return t.stop()}},t)}))}},{key:"appendRootElementIfNeededAndReturnIt",value:function(e){return Object(d.a)("VideoRecorderRootElement",e.getSingleton(b.a).ownerDocument)}},{key:"closeVideoRecorder",value:function(e,t){Object(v.a)(t.getSingleton(b.a).dispatch),g.unmountComponentAtNode(e)}},{key:"overrideWebRecorderStrings",value:function(e){e["capture_page.title.webcam"]=m.toString(),e["edit_page.next_button.label"]=k.toString(),e["edit_page.title"]=C.toString(),e["edit_page.recording_timeout_dialog.review.recording"]=C.toString(),e["edit_page.back_confirm_dialog.title"]=j.toString(),e["edit_page.back_confirm_dialog.confirm"]=y.toString(),e["edit_page.back_confirm_dialog.cancel"]=S.toString(),e["edit_page.back_confirm_dialog.body"]=O.toString()}}]),e}(),M=function(e,t,n,r){return new(n||(n=i.a))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}u((r=r.apply(e,t||[])).next())})},K=function(e,t){var n=function(n){return M(void 0,void 0,void 0,o.a.mark(function r(){return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,F(n,e,t);case 2:case"end":return r.stop()}},r)}))};window.setTimeout(function(){(new _).renderVideoRecorder(t,t.appContext,n)},0)};function F(e,t,n){return M(this,void 0,void 0,o.a.mark(function r(){var a,i,s;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=21;break}return r.prev=1,n.dispatch(Object(u.m)({personaLpcKey:t.lpcKey})),r.next=5,Object(c.a)(n,t);case 5:if(a=r.sent,r.t0=a.SessionToken,!r.t0){r.next=10;break}return r.next=10,Object(c.d)(e,a.SessionToken,n,t);case 10:return r.next=12,Object(c.c)(t,n);case 12:i=r.sent,s=i.PlaybackUrl,n.dispatch(s?Object(u.j)({personaLpcKey:t.lpcKey}):Object(u.k)({personaLpcKey:t.lpcKey})),r.next=21;break;case 17:throw r.prev=17,r.t1=r.catch(1),n.dispatch(Object(u.k)({personaLpcKey:t.lpcKey})),r.t1;case 21:case"end":return r.stop()}},r,null,[[1,17]])}))}function B(e,t){return M(this,void 0,void 0,o.a.mark(function n(){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=5;break}return n.next=3,Object(c.b)(t,e);case 3:return n.next=5,Object(c.c)(e,t);case 5:case"end":return n.stop()}},n)}))}},1386:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(19),o=n(443),a=n(176),i=Object(a.a)(function(e){if(e&&e.InternalReplyMessage)return{start:Object(o.j)(e.DurationStartTimeUtc),end:Object(o.j)(e.DurationEndTimeUtc),message:e.InternalReplyMessage||""}}),c=Object(a.a)(function(e){if(e&&e.oofMessage)return{start:void 0,end:void 0,message:e.oofMessage||""}}),u=n(400);function s(e,t){var n=r.E.getSelectors(e).getLatestSuccess(t),o=u.a.getSelectors(e).getPersonaPresence(t);return n&&i(n)||c(o)}},1405:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),o=n(127),a=n(1241);function i(){var e=Object(o.e)();return r.useCallback(function(t,n){e(t?Object(a.b)({targetName:n}):Object(a.a)({targetName:n}))},[e])}},1433:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(566),o=Object(r.a)(function(e){return{webRecorderCustomStyles:{selectors:{"#screenRecorderUIRoot video":{background:e.palette.white},"#screenRecorderUIRoot .fgr-videoPlayer":{background:e.palette.white},'#screenRecorderUIRoot [class^="capturePanelContainer"]':{gridTemplateRows:"minmax(60px, max-content) auto minmax(104px, max-content)",gridTemplateAreas:'"titleArea" "video" "actions"'},'[class^="overlayBackdropLight"]':{width:"252px",left:"272px"}}}}}),a=Object(r.b)({scrollableContent:{overflowY:"initial"}}),i=Object(r.b)({spinnerStyles:{height:"100%"},cancelButtonStyles:{top:"0px",right:"0px",position:"absolute"},modalWrapperStyles:{width:840,height:647}})},1528:function(e,t,n){var r={"./language-ar":[1446,20],"./language-ar.js":[1446,20],"./language-az-latn-az":[1447,34],"./language-az-latn-az.js":[1447,34],"./language-bg":[1448,44],"./language-bg.js":[1448,44],"./language-bs-latn-ba":[1449,55],"./language-bs-latn-ba.js":[1449,55],"./language-ca":[1450,66],"./language-ca.js":[1450,66],"./language-cs":[1451,21],"./language-cs.js":[1451,21],"./language-cy-gb":[1452,30],"./language-cy-gb.js":[1452,30],"./language-da":[1453,31],"./language-da.js":[1453,31],"./language-de":[1454,32],"./language-de.js":[1454,32],"./language-el":[1455,33],"./language-el.js":[1455,33],"./language-en":[1457,19],"./language-en-gb":[1456,35],"./language-en-gb.js":[1456,35],"./language-en.js":[1457,19],"./language-es":[1459,37],"./language-es-mx":[1458,36],"./language-es-mx.js":[1458,36],"./language-es.js":[1459,37],"./language-et":[1460,38],"./language-et.js":[1460,38],"./language-eu":[1461,39],"./language-eu.js":[1461,39],"./language-fi":[1462,40],"./language-fi.js":[1462,40],"./language-fil-ph":[1463,41],"./language-fil-ph.js":[1463,41],"./language-fr":[1465,43],"./language-fr-ca":[1464,42],"./language-fr-ca.js":[1464,42],"./language-fr.js":[1465,43],"./language-ga-ie":[1466,45],"./language-ga-ie.js":[1466,45],"./language-gl":[1467,46],"./language-gl.js":[1467,46],"./language-he":[1468,47],"./language-he.js":[1468,47],"./language-hi":[1469,48],"./language-hi.js":[1469,48],"./language-hr":[1470,49],"./language-hr.js":[1470,49],"./language-hu":[1471,50],"./language-hu.js":[1471,50],"./language-id":[1472,51],"./language-id.js":[1472,51],"./language-is":[1473,52],"./language-is.js":[1473,52],"./language-it":[1474,53],"./language-it.js":[1474,53],"./language-ja":[1475,54],"./language-ja.js":[1475,54],"./language-ka":[1476,56],"./language-ka.js":[1476,56],"./language-kk":[1477,57],"./language-kk.js":[1477,57],"./language-ko":[1478,58],"./language-ko.js":[1478,58],"./language-lt":[1479,59],"./language-lt.js":[1479,59],"./language-lv":[1480,60],"./language-lv.js":[1480,60],"./language-mk":[1481,61],"./language-mk.js":[1481,61],"./language-ms":[1482,62],"./language-ms.js":[1482,62],"./language-nb-no":[1483,63],"./language-nb-no.js":[1483,63],"./language-nl":[1484,64],"./language-nl.js":[1484,64],"./language-nn-np":[1485,65],"./language-nn-np.js":[1485,65],"./language-pl":[1486,67],"./language-pl.js":[1486,67],"./language-prs-af":[1487,68],"./language-prs-af.js":[1487,68],"./language-pt-br":[1488,69],"./language-pt-br.js":[1488,69],"./language-pt-pt":[1489,70],"./language-pt-pt.js":[1489,70],"./language-ro":[1490,71],"./language-ro.js":[1490,71],"./language-ru":[1491,72],"./language-ru.js":[1491,72],"./language-sk":[1492,73],"./language-sk.js":[1492,73],"./language-sl":[1493,74],"./language-sl.js":[1493,74],"./language-sq":[1494,75],"./language-sq.js":[1494,75],"./language-sr-cyrl-rs":[1495,76],"./language-sr-cyrl-rs.js":[1495,76],"./language-sr-latn-rs":[1496,22],"./language-sr-latn-rs.js":[1496,22],"./language-sv":[1497,23],"./language-sv.js":[1497,23],"./language-th":[1498,24],"./language-th.js":[1498,24],"./language-tr":[1499,25],"./language-tr.js":[1499,25],"./language-uk":[1500,26],"./language-uk.js":[1500,26],"./language-vi":[1501,27],"./language-vi.js":[1501,27],"./language-zh-cn":[1502,28],"./language-zh-cn.js":[1502,28],"./language-zh-tw":[1503,29],"./language-zh-tw.js":[1503,29]};function o(e){if(!n.o(r,e))return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=r[e],o=t[0];return n.e(t[1]).then(function(){return n.t(o,7)})}o.keys=function(){return Object.keys(r)},o.id=1528,e.exports=o},1558:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(113);function o(e,t){var n,o=e.hostAppConfiguration.actionCallbacks;if(o&&o.onTagClick)try{t&&(null===(n=o.onTagClick)||void 0===n||n.call(o,t.name))}catch(e){Object(r.c)("onTagClick action callback failed: "+e)}}},1604:function(e,t,n){"use strict";n.d(t,"a",function(){return I}),n.d(t,"b",function(){return N});var r=n(1974),o=n(1308),a=n(1172),i=n(20),c=n(0),u=n(1352),s=n(340),l=n(1194),d=n(1405),f=n(73),p=n.n(f),g=n(165),b=n.n(g),v=n(101),h=n.n(v),m=n(199),C=n.n(m),j=n(7),O=n(176),y=n(446);function S(e,t){var n=void 0!==h.a&&e[b.a]||e["@@iterator"];if(!n){if(p()(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return C()(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=Object(O.a)(function(e,t,n,r,o,a){var i,c=[],u=S(e);try{var s=function(){var e=i.value;c=c.concat(e.content?e.content.map(function(i,c){return A({firstLine:i.displayString,secondLine:void 0,contactLinkType:e.contactType,index:c,lpcAppContext:t,emailClicked:n,startChatClicked:r,callPhoneClicked:o,updateProfileVideoClicked:a,href:i.hrefLink,contactLinkSubType:i.fieldType,linkIcon:i.linkIcon})}):[])};for(u.s();!(i=u.n()).done;)s()}catch(e){u.e(e)}finally{u.f()}return c}),w=Object(O.a)(function(e,t,n,r,o,a,i,c,u,s){var l,d=[],f=S(e);try{for(f.s();!(l=f.n()).done;){var p=l.value,g=P(p);d=d.concat("unknown"!==g&&p.firstLine?A({firstLine:p.firstLine,secondLine:p.secondLine,contactLinkType:g,index:0,lpcAppContext:t,emailClicked:r,startChatClicked:o,callPhoneClicked:a,updateProfileVideoClicked:i,retryProfileVideoUploadClicked:c,href:p.url,contactLinkSubType:p.contactInfoType,linkIcon:p.icon,label:p.label,tooltip:p.tooltip,dataSources:p.source,fallbackDataSource:p.fallbackSource,person:u,dataSourceLabels:n,consumerChatHandle:s}):[])}}catch(e){f.e(e)}finally{f.f()}return d});function P(e){var t=e.label?e.label.replace(/\s/g,"").toLowerCase():"unknown";return"unknown"!==e.contactLinkType?e.contactLinkType:t}var A=Object(O.a)(function(e){var t=e.firstLine,n=e.secondLine,r=e.contactLinkType,o=e.index,a=e.lpcAppContext,i=e.emailClicked,c=e.startChatClicked,u=e.callPhoneClicked,s=e.updateProfileVideoClicked,l=e.retryProfileVideoUploadClicked,d=e.href,f=e.contactLinkSubType,p=e.linkIcon,g=e.label,b=e.tooltip,v=e.dataSources,h=e.fallbackDataSource,m=e.person,C=e.dataSourceLabels,j=e.consumerChatHandle,O=0===o?p||T(r):void 0;return{label:g,showInferredData:a.settings.isInferredContactsEnabled,isInferredData:v&&1===v.length&&v[0]===y.a,labelHoverText:C&&v&&function(e,t){var n=t.foundInEmail;if(!e)return"";return 1===e.length&&e[0]===y.a?n:e.filter(function(e){return e&&e!==y.a}).map(function(e){return function(e,t){switch(e){case"Directory":return t.sourceDirectory;case"Contact":return t.sourceContact;case"Custom":return t.sourceCustom;default:return e}}(e,t)}).join(t.dataSourceSeparator)}(v,C)||h,contactLinkType:r,contactLinkSubType:f,firstLine:t,secondLine:n,firstLineHoverText:b,icon:O,onClick:E(t,r,o,i,c,u,s,l,d,m,j,f)}});var E=Object(O.a)(function(e,t,n,r,o,a,i,c,u,s,l,d){var f=c?function(){return c()}:void 0;switch(t){case"email":return r?function(){return r(e,n)}:void 0;case"phone":case"mobile":case"workphone":return u&&d&&a?function(){return a(u,d,n)}:void 0;case"chat":return s&&o?function(){return o(s,e,l)}:void 0;case"updateprofilevideo":return i?function(){return i()}:void 0;case"uploadfailprofilevideo":return f;default:return}}),T=Object(O.a)(function(e){switch(e){case"email":return j.b.Mail;case"phone":return j.b.Phone;case"website":return j.b.Globe;case"location":return j.b.Location;case"timezone":return j.b.Clock;case"updateprofilevideo":return j.b.VideoAdd;default:return j.b.People}});function I(e){var t=e.onTitleClick,n=e.onFooterClick,o=e.onUpdateProfileVideoClick,i=e.contacts,s=e.showLoading,f=e.showError,p=void 0!==f&&f,g=e.additionalChildren,b=e.additionalAvailabilityInfo,v=e.mixedChatDisclaimerProps,h=e.hideTitle,m=Object(l.a)(),C=Object(a.b)(),j=x(i,m,function(e,t){return Object(u.c)(e,{sourceSectionType:"Card",index:t,applicationContext:m,logger:C})},function(e,t){return Object(u.a)(m,e,"Card",C)},function(e,t,n){return Object(u.d)(m,n,e)},function(){o&&o()}),O=b&&b.length?x(b,m):void 0,y=Object(d.a)();return c.createElement(r.a,{logName:"UserInfoBlock",showLoading:s,showError:p,onTitleClick:m.settings.useMicrosoftTeamsFeatures?void 0:t,onFooterClick:n,contacts:j,additionalChildren:g,additionalAvailabilityInfo:O,hideFooter:m.settings.useMicrosoftTeamsFeatures,hideTitle:h,onCopied:y,mixedChatDisclaimerProps:v})}var L=Object(i.db)({marginLeft:"-28px",marginRight:"-28px"}),D={panel:{panelContent:function(){return{panel:{padding:"12px 0 0"}}}}};function N(e){var t=e.onFooterClick,n=e.onUpdateProfileVideoClick,i=e.onPlayProfileVideoClick,f=e.onDeleteProfileVideoClick,p=e.onContactPopupOpened,g=e.contacts,b=e.showLoading,v=e.showError,h=void 0!==v&&v,m=e.hideFooter,C=void 0===m||m,j=e.person,O=e.sectionType,y=e.consumerChatHandle,S=e.additionalChildren,k=e.additionalAvailabilityInfo,x=Object(l.a)(),P=Object(a.b)(),A=Object(o.e)(),E=function(){j&&x.dispatch(Object(s.l)({retryUpload:!0}))},T=w(g,x,A,function(e,t){return Object(u.c)(e,{sourceSectionType:O,index:t,applicationContext:x,logger:P})},function(e,t,n){return Object(u.a)(x,e,O,P,n)},function(e,t,n){return Object(u.d)(x,n,e)},function(){n&&n()},E,j,y),I=x.settings.isRichAvailabilityInfoEnabled&&k&&k.length?w(k,x,A,void 0,void 0,void 0,function(){n&&n()},E):void 0,N=Object(d.a)();return c.createElement("div",{className:L},c.createElement(r.a,{logName:"UserInfoBlockLarge",showLoading:b,showError:h,onFooterClick:t,contacts:T,additionalChildren:S,additionalAvailabilityInfo:I,hideFooter:C,onCopied:N,showLargeLink:!0,onPlayProfileVideoClick:i,onDeleteProfileVideoClick:f,onContactPopupOpened:p,styleOverrides:D}))}},1648:function(e,t,n){"use strict";n.d(t,"b",function(){return p}),n.d(t,"a",function(){return g});var r=n(83),o=n.n(r),a=n(59),i=n.n(a),c=n(6),u=n.n(c),s=n(2),l=n(38),d=n(572),f=n(346);function p(e){return b("Loki",e)}function g(e){var t=b("HostApp",e);return function(e){return t(function(){return e})}}function b(e,t){var n=Object(d.c)();return function(r){return function(){return new u.a(function(o){var a=i()(),c={requestId:Object(l.a)(),clientScenario:t.scenario,hostAppApp:n.appSessionProps.hostAppApp};o(r(c)().then(function(r){if("success"===r.state||"no_data"===r.state||"error"===r.state){var o=i()()-a,u="success"===r.state&&t.getMisc?t.getMisc(r.data):void 0,s={source:e,fetch:t,misc:u,requestCorrelationId:c.requestId,responseCorrelationId:void 0,duration:o,result:r.state};"error"===r.state&&(s.errorCode=r.errorCode),v(s,n)}return r}))})}}}var v=function(e,t){var n=t.telemetryCallbacks,r=t.hostAppSessionProps,o=t.appSessionProps;n.logFetchEvent(h(e,r,o))},h=function(e,t,n){return Object(s.__assign)(Object(s.__assign)({},Object(f.a)(t,n)),{duration:e.duration,errorCode:e.errorCode,misc:o()(e.misc),requestCorrelationId:e.requestCorrelationId,responseCorrelationId:e.responseCorrelationId,result:e.result,scenario:e.fetch.scenario,source:e.source})}},1749:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(222),o=n(403),a=n(574),i=n(1281);function c(e,t){var n=Object(a.c)(),c=Object(o.e)(e,function(e,t){return{onMutate:function(n){var r;return null===(r=null==t?void 0:t.onMutate)||void 0===r?void 0:r.call(t,e,n)},onSuccess:function(n,r){var o;return null===(o=null==t?void 0:t.onSuccess)||void 0===o?void 0:o.call(t,e,n,r)},onError:function(n,r,o){var a;return null===(a=null==t?void 0:t.onError)||void 0===a?void 0:a.call(t,e,n,r,o)},onSettled:function(n,r,o,a){var i;return null===(i=null==t?void 0:t.onSettled)||void 0===i?void 0:i.call(t,e,n,r,o,a)},throwOnError:Boolean(null==t?void 0:t.throwOnError)}}(n,t)),u=Object(r.a)(c,2),s=u[0],l=u[1],d=l.data,f=l.status,p=l.error;return[s,Object(i.d)(f,d,p)]}},1791:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return f}),n.d(t,"b",function(){return p});var r=n(698),o=n(1246),a=n(1212),i=n(31),c=n(208),u=n(342),s=n(260);function l(e,t){var n=[],r=[],o=e.map(function(e){return e&&e.toLowerCase()});return e.forEach(function(e,a){o.indexOf(e&&e.toLowerCase())===a&&(r.push(t[a]),n.push(e))}),n.map(function(e,t){return{displayString:e,hrefLink:r[t]}})}function d(e){if(Object(i.p)(e)){if(!Object(c.d)(e.officeLocation))return{address:e.officeLocation,locationType:"OfficeLocation"};if(e.postalAddresses.length>0){var t=Object(r.a)(e.postalAddresses,function(e){return"Business"===e.Type});if(t)return{address:Object(u.a)(t),locationType:"BusinessAddress"};if(t=Object(r.a)(e.postalAddresses,function(e){return"Home"===e.Type}))return{address:Object(u.a)(t),locationType:"HomeAddress"};var n=e.postalAddresses[0];if(void 0!==n)return{address:Object(u.a)(n),locationType:"PostalAddress"}}}return{address:"",locationType:"PostalAddress"}}function f(e,t,n){var r=Object(o.c)(e,t),i=Object(a.c)(e,t.timeFormats);return{fieldType:"TimeZone",displayString:Object(a.d)(r,i,n)}}function p(e,t,n,r,o,i,c,u){var l;if(t){var d=null!==(l=function(e,t,n,r,o,i,c){var u,s,l,d,f,p=null!==(u=n.isOutOfOffice)&&void 0!==u&&u;return f=p?Object(a.b)(null==t?void 0:t.end,o,c):Object(a.a)(null!==(s=null==e?void 0:e.UtcDateTime)&&void 0!==s?s:void 0,null!==(l=null==e?void 0:e.CurrentStatus)&&void 0!==l?l:void 0,null!==(d=null==e?void 0:e.NextStatus)&&void 0!==d?d:void 0,o,c),""===r||!f||i||p?p&&f?f:r:Object(a.g)({presence:r,nextAvailability:f})}(e,n,t,r,o,c,u))&&void 0!==l?l:"",f=function(e,t){return Object(s.b)(null==e?void 0:e.presence,e.isOutOfOffice,t)}(t,i);if(f&&""!==d)return{linkIcon:f,fieldType:"NextAvailability",displayString:d}}}},1843:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(857),o=n(858),a=n(1180),i=n(1189),c=n(572),u=n(859),s=n(0),l=n(110);var d=function(e){switch(e){case"success":case"no_data":return"Success";case"error":return"UnexpectedFailure";default:return Object(l.b)(e,"Unknown")}},f=function(e){return e&&JSON.parse(e)},p=function(e){var t=e.logger,n=e.featureName,l=e.eventFieldMap,p=e.getRenderScenario,g=e.children,b={telemetryCallbacks:function(e,t,n){return{logSessionStartEvent:function(e){},logSessionEndEvent:function(e){},logUserActionEvent:function(r){var o=[r.path,r.moduleName,r.action].join("."),a=n.UserAction,i=a&&a[o]||o,c={exportType:"UserInteraction",exportName:"".concat(r.moduleName,"_").concat(r.action)};e.logEvent({eventId:i,featureName:t,properties:f(r.misc),exportOptions:c})},logFetchEvent:function(r){var o=n.Fetch,a=o&&o[r.scenario]||r.scenario;e.logQoS(a,d(r.result),r.result.toString(),t,r.duration,r.source,r.requestCorrelationId||"",f(r.misc))},logRenderEvent:function(n){var r=n.action,o=n.state,a=n.targetView,i=n.components,c=n.componentsWithError,u=n.duration,s=n.preRenderLatency,l=n.renderLatency,d=n.eupl;e.logEUPL("".concat(r,"-eupl"),t,u,{action:r,state:o,targetView:a,components:i,componentsWithError:c,duration:u.toString(),preRenderLatency:(null==s?void 0:s.toString())||"",renderLatency:(null==l?void 0:l.toString())||"",eupl:(null==d?void 0:d.toString())||""})},logErrorEvent:function(n){n.midgardError&&e.logError({eventId:n.midgardError.family+"-error",featureName:t,properties:{midgardError:n.midgardError}})},registerErrors:function(t,n){e.registerErrors(t,n)},lookupError:function(e){return["",void 0,""]},errorMap:{}}}(t,n,l),hostAppSessionProps:r.a,appSessionProps:o.a},v=s.useCallback(function(){return Object(a.a)()},[]),h=Object(i.b)(b,p||v);return s.createElement(c.a,{telemetry:b,getSize:function(){return""}},s.createElement(u.a.Provider,{value:h},g))}},1850:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1066),o=n(1281),a=n(1749),i=n(1322),c=n(1648),u=n(634);function s(){var e=Object(u.b)(),t=Object(c.b)({scenario:"CategoriesPatch"});return Object(a.a)(function(n){var r,a="DELETE"===n.action?(r=n.category,{id:n.contactId,tags:r.map(function(e){return{id:e.id,action:"DELETE"}})}):function(e,t){return{id:t,tags:[{action:"POST",body:{displayName:e.name,color:{backgroundColor:e.color}}}]}}(n.category,n.contactId);return t(function(t){return Object(i.a)(e,{contactV3UpdateRequest:a},t)})().then(Object(o.e)(l))})}function l(e){if(e)return(e.tags||[]).filter(function(e){return e.displayName&&e.id}).map(function(e){var t;return{name:e.displayName||"",id:e.id||"",creationTime:e.createdDateTime||"",color:Object(r.b)(null===(t=e.color)||void 0===t?void 0:t.backgroundColor)}})}},2021:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(2),o=n(1850),a=n(271),i=n(0),c=n.n(i),u=c.a.lazy(function(){return n.e(95).then(n.bind(null,2558))});function s(e){return c.a.createElement(c.a.Suspense,{fallback:null},c.a.createElement(u,Object(r.__assign)({},e)))}var l=n(630);function d(e){var t=this,n=e.tags,u=e.showAll,d=e.showDelete,f=e.contactId,p=e.onTagDelete,g=e.onShowMoreClick,b=e.onTagClick,v=Object(r.__read)(Object(o.a)(),1)[0],h=Object(i.useCallback)(function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,n,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return null==p||p({status:a.b.Pending,tags:[e]}),[4,v({contactId:f,action:"DELETE",category:[e]})];case 1:return t=r.sent(),(n=t&&"success"===t.state&&t.data?null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.filter(function(t){return t.name===e.name}):[]).length&&(null==p||p({status:a.b.Failed,tags:n})),[2]}})})},[p,v,f]);return c.a.createElement(l.a,{name:"ContactCategoryPanel"},c.a.createElement(s,{tags:n,showAll:u,showDelete:d,onTagDelete:h,onShowMoreClick:g,onTagClick:b}))}}}]);