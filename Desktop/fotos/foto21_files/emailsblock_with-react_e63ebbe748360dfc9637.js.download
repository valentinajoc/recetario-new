/*! Version: 4.2.18; Third Party Notices: https://res-1.cdn.office.net/midgard/versionless/tpn-051bef26f294aad48d7d2c6c9f68d420e57dcaf2a94d49ca38799572faa8aea06ad5c9e2affa2eb8bc6dacd881cb2182fce35aecdad68ab1530a7401af444b32.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[106],{1112:function(e,n,t){"use strict";t.r(n),t.d(n,"EmailsBlockView",function(){return x});var r=t(27),i=t.n(r),o=t(45),a=t(46),c=t(81),s=t(80),u=t(51),p=t(1079),l=t(443),d=t(2551),f=t(176),b=t(1170),m=t(1217),g=t(0),h=t(127),v=t(1579),j=t(44),O=t(121),w=t(639),y=t(399);function C(e){var n=function(){if("undefined"==typeof Reflect||!i.a)return!1;if(i.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var t,r=Object(u.a)(e);if(n){var o=Object(u.a)(this).constructor;t=i()(r,arguments,o)}else t=r.apply(this,arguments);return Object(s.a)(this,t)}}var x=function(e){Object(c.a)(t,e);var n=C(t);function t(){var e;return Object(o.a)(this,t),(e=n.apply(this,arguments)).getConvertedEmails=Object(f.a)(function(n){return n.map(function(n){return e.getEmailFromIEmail(n)})}),e}return Object(a.a)(t,[{key:"render",value:function(){var e=this,n=this.props.persona;if(!n||Object(j.b)(n))return null;var t=this.getConvertedEmails(this.props.emails);return g.createElement(d.a,{persona:n,messageEntities:t,isLoading:this.props.isLoading,isMePersona:this.props.isMePersona,showError:this.props.hasFailed,onTitleClick:function(){return v.d(n,e.lpcAppContext,e.props.renderingContext)},onFooterClick:function(){return v.b(n,e.lpcAppContext,e.props.renderingContext)},onRetryClick:function(){return v.c(n,e.lpcAppContext)},onMessageEntityClick:function(r,i){return v.a(e.props.emails[t.indexOf(r,0)],n.lpcKey,e.lpcAppContext,i)}})}},{key:"getEmailFromIEmail",value:function(e){return{subject:e.Subject,preview:e.Preview,emailFrom:e.From,fromName:e.FromName,received:Object(p.a)(Object(l.j)(e.Received)||Object(l.i)(),new Date,Object(y.b)(this.lpcAppContext),this.lpcAppContext.logger),isRead:e.IsRead,hasAttachments:e.HasAttachments,isAtMentioned:e.IsAtMentioned,flagStatus:e.FlagStatus,importance:e.Importance,kind:"Email"}}}]),t}(t(192).a);var E=Object(m.a)(x,function(e){var n=e.persona,t=e.hasFailed,r=e.isLoading,i=e.emails,o=e.isMePersona;return{componentName:"EmailsBlock",identifier:n&&n.lpcKey.key||"",logProperties:{hasFailed:t,isLoading:r,emailsCount:i.length.toString(),isMePersona:o}}}),k=Object(h.c)(function(e,n){var t=Boolean(Object(w.a)(e,n.persona));if(!n.persona)return{emails:[],isLoading:!1,hasFailed:!1,isMePersona:t};var r=Object(O.d)(e,n.persona.lpcKey);return{emails:r.emails,isLoading:r.isLoading,hasFailed:r.hasError,isMePersona:t}})(Object(b.a)(E));n.default=k},1203:function(e,n,t){"use strict";t.d(n,"a",function(){return s});var r=t(150),i=t(2),o=t(0),a=t(644),c=t(1259);function s(e){var n=Object(a.c)(),t=Object(a.d)(),s=e.identifier,u=e.logProperties,p=t+e.componentName,l=Object(o.useRef)(null),d=Object(o.useRef)(null),f=Object(o.useRef)(null),b=Object(o.useRef)(0);Object(o.useEffect)(function(){return null===l.current&&(l.current=c()),function(){d.current||(d.current=c());var e=l.current&&d.current?d.current-l.current:void 0,t=void 0!==e&&Math.round(e).toString()||"";if(n){var r=Object(i.__assign)({component:p,duration:t,renderCount:b.current.toString()},f.current);n(p,r)}l.current=null,f.current=null,d.current=null,b.current=0}},[s,p]),Object(o.useEffect)(function(){Object(r.a)(u,f.current)||(b.current++,d.current=c(),f.current=u)},[p,u])}},1217:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(2),i=t(0),o=t(1203);function a(e,n){return function(t){var a=n(t);return Object(o.a)(a),i.createElement(e,Object(r.__assign)({},t))}}},1259:function(e,n,t){(function(n){(function(){var t,r,i,o,a,c;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=n&&n.hrtime?(e.exports=function(){return(t()-a)/1e6},r=n.hrtime,o=(t=function(){var e;return 1e9*(e=r())[0]+e[1]})(),c=1e9*n.uptime(),a=o-c):Date.now?(e.exports=function(){return Date.now()-i},i=Date.now()):(e.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(this,t(878))},1579:function(e,n,t){"use strict";t.d(n,"c",function(){return g}),t.d(n,"d",function(){return h}),t.d(n,"b",function(){return v}),t.d(n,"a",function(){return O}),t.d(n,"e",function(){return w});var r=t(10),i=t.n(r),o=t(6),a=t.n(o),c=t(554),s=t(132),u=t(189),p=t(242),l=t(166),d=t(649),f=t(441),b=t(570),m=function(e,n,t,r){return new(t||(t=a.a))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function c(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,c)}s((r=r.apply(e,n||[])).next())})};function g(e,n){return m(this,void 0,void 0,i.a.mark(function t(){var r,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.dispatch(Object(u.c)({personaLpcKey:e.lpcKey})),r=n.getState(),o=d.a.getSelectors(r).getCardTemplateFailed(e.lpcKey),t.next=5,Object(b.b)(e,"",o,n,n.logger,void 0,void 0);case 5:case"end":return t.stop()}},t)}))}function h(e,n,t){var r=j(e,n),i=Object(p.b)(n);r&&i?(Object(s.k)(e,{applicationContext:n,renderingContext:t,cardCorrelationId:n.cardCorrelationId||"",logger:n.logger}),n.dispatch(Object(u.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Conversations",windowId:t.windowId,navigationStartCheckpoint:Object(c.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),i.renderExpandedView(n,"Conversations")):n.dispatch(Object(u.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1}))}function v(e,n,t){var r=j(e,n),i=Object(p.b)(n);r&&i?(Object(s.k)(e,{applicationContext:n,renderingContext:t,cardCorrelationId:n.cardCorrelationId||"",logger:n.logger}),n.dispatch(Object(u.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Conversations",windowId:t.windowId,navigationStartCheckpoint:Object(c.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),i.renderExpandedView(n,"Conversations")):n.dispatch(Object(u.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1}))}function j(e,n){var t=Object(p.b)(n);return n.settings.isImmersiveProfileEnabled&&!!t&&!Object(l.a)(e)}function O(e,n,t,r,i){t.dispatch(Object(u.a)({email:e,indexClicked:r,personaLpcKey:n})),Object(f.h)(t,t.logger)(e,n,i)}function w(e,n,t,r){t.dispatch(Object(u.f)({email:e,personaLpcKey:n})),Object(f.h)(t,t.logger)(e,n,r)}}}]);